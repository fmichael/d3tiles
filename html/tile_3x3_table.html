<div class='front'>
    <div class='setting_span'>
        <button class='setting_btn fill_btn'>Y</button>
        <span class='setting_btn title_area'><span class='tile_title'></span></span>
        <button class='setting_btn swap_btn pull-right'>X</button>
    </div>
    <div class='contents'></div>
</div>
<div class='back'>
    <div class='setting_span'>
        <button class='swap_btn save_btn first'>Save</button>
    </div>
    <div class='contents'>
        <div class='settings'>
            <input setFilt='search' type='checkbox'>Enable Search</input><br />
            <input setFilt='sort' type='checkbox'>Enable Sort</input><br />
            <input setFilt='recordCount' type='checkbox'>Enable Record Count</input><br />
            <input setFilt='paginate' type='checkbox'>Pagination?</input><br />
            <input setFilt='perPageSelect' type='checkbox'>Per Page # of Reconds</input><br />
        </div>
        <div class='filter'>
            Min: <input setFilt='min' class='min' type='input' /><br />
            Max: <input setFilt='max' class='max' type='input' /><br />
        </div>
    </div>

    <style class='tile_3x3_table_css'>
    </style>

    <script class='tile_3x3_table_js'>
        var tile_3x3_table_js = function() {
            console.log("SHOOT");
        }
    </script>
</div>

<div class="tile_3x3_table_modal modal floatLeftSlide">
    <input type='hidden' value='new_3x3_table_tile' />
    <span class="closeModalButton">x</span>
    <span class="title">Create a new 3x3 Table Tile</span>
    <div class="form">
        <span class='title'>Title: <input type='text' required></input></span>
    </div>
    <div class="footer">
        <button class="cancelButton">Cancel</button>
        <button class="confirmButton">Confirm</button>
    </div>
    <script> /* Validation Code, Confirmation Code, etc */
        $('.confirmButton').on('click', function() { //no need for specific names since only one modal is allowed at a time on screen
            if($('.form > .title > input').val() == '') {
                $('.form > .title > input').addClass('error');
                return;
            }
            else
                $('.form > .title > input').removeClass('error');
            var groupid = viewable.pageList[viewable.activePage].addGroup('group_'+viewable.activePage);
            viewable.pageList[viewable.activePage].groupList[groupid].addData(makeData('table'));
            viewable.pageList[viewable.activePage].groupList[groupid].addTile('tile_', 3, 3, 'table');
            viewable.closeModal('floatRightSlide');
        });
    </script>
</div>

<script class='saving_function'>
    function tile_3x3_table_save() {
        var thee = this;
        $('#'+this.id).find('.contents').children().each(function() {
            var which = 'settings';
            if ($(this).hasClass('settings'))
                which = 'settings';
            else if ($(this).hasClass('filter'))
                which = 'filters';

            $(this).children().each(function() {
                var value = false;
                var found = false;
                //grab each setting
                if ($(this).context.localName == 'input') {
                    switch($(this).attr('type')) {
                        case 'checkbox':
                            if($(this).is(":checked"))
                                value = true;
                            else
                                value = false;
                        break;
                        case 'radio':
                            if($(this).is(":checked"))
                                value = true;
                            else
                                value = false;
                        break;
                        case 'text':
                        case 'number':
                        case 'range':
                        case 'input':
                            if($(this).val() !== '')
                                value = $(this).val();
                        break;
                    }
                    found = true;
                }
                else if ($(this).context.localName == 'textarea') {
                    if($(this).val() !== '') {
                        value = $(this).val();
                        found = true;
                    }
                }
                else if ($(this).context.localName == 'select') {
                    if($(this).val() !== '') {
                        value = $(this).val();
                        found = true;
                    }
                }
                if (found) {
                    if (which == 'settings')
                        thee.settings[$(this).attr('setFilt')] = value;
                    else
                        thee.filters[$(this).attr('setFilt')] = value;
                }
            });
        });
    }

</script>

<script class='drawing_function'>
    function tile_3x3_table_draw() {
        $('#drawable_'+this.id).empty();
        var appender = '<div class="table_cont"><table id="table_'+this.id+'" class="table table-bordered"><thead>';
        var objects = [];
        var length = 0;
        for(var iter in this.parent.data) {
            appender += '<th>'+iter+'</th>';
            length = this.parent.data[iter].length;
        }
        appender += '</thead><tbody>';

        for(var x = 0; x < length; x++) {
            objects[x]= {};
        }
        for(var iter in this.parent.data) {
            for(var iteriter in this.parent.data[iter]) {
                objects[iteriter][iter] = this.parent.data[iter][iteriter];
            }
        }
        appender += '</tbody></table></div>';
        $('#drawable_'+this.id).append(appender);
        this.interactiveObject = $('#table_'+this.id).dynatable({
            features: this.settings,
            dataset: {
                records: objects
            }
        });
    }
</script>